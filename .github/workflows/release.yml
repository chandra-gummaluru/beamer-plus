name: Create Release

on:
  push:
    tags:
      - 'v*.*.*'  # Triggers when you push a tag like v1.0.0

permissions:
  contents: write

jobs:
  create-release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Create source archive
        run: |
          mkdir -p release
          zip -r release/beamer-plus-source.zip . \
            -x "*.git*" \
            -x "*__pycache__*" \
            -x "*.pyc" \
            -x "*uploads/*" \
            -x "release/*"

      - name: Create release
        uses: softprops/action-gh-release@v1
        with:
          files: release/beamer-plus-source.zip
          body: |
            ## Beamer+ Release
            
            Download the source code and run locally with Python.
            
            ### Requirements
            - Python 3.8 or higher
            - pip (Python package installer)
            
            ### Quick Start
            1. Download `beamer-plus-source.zip`
            2. Extract the archive
            3. Open a terminal in the extracted folder
            4. Install dependencies: `pip install -r requirements.txt`
            5. Run the launcher: `python launch-beamer-plus.py`
            6. Browser opens to http://localhost:5000
            7. Upload and present!
            
            ### Features
            - Interactive presentations with PDF slides
            - Drawing and annotation tools
            - Real-time surveys with AI-powered summarization
            - Video and 3D model embedding
            - Custom widgets support
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
